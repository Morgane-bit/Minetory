<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Connexion / Inscription - Location Maisons</title>
<style>
 :root {
  --bg: #f4f4f9;
  --text: #333;
  --primary: #2c3e50;
  --primary-dark: #1a252f;
  --card-bg: #fff;
  --btn-bg: #2c3e50;
  --btn-text: #fff;
  --input-bg: #fff;
  --input-border: #ccc;
  --success: #27ae60;
  --error: #e74c3c;
  --header-bg: #2c3e50; /* Semblant de gris similaire √† accueil */
  --header-text: #fff;
  --header-bg-dark: #111; /* header en mode sombre */
}

body.dark {
  --bg: #121212;
  --text: #eee;
  --primary: #34495e;
  --primary-dark: #1a252f;
  --card-bg: #1e1e1e;
  --btn-bg: #1abc9c;
  --btn-text: #fff;
  --input-bg: #2a2a2a;
  --input-border: #555;
}

body {
  font-family: Arial, sans-serif;
  margin: 0;
  background: var(--bg);
  color: var(--text);
  transition: all 0.3s;
}

header {
  background: var(--header-bg);
  color: var(--header-text);
  padding: 1rem;
  text-align: center;
  position: sticky;
  top: 0;
  z-index: 1000;
  border-bottom: 1px solid var(--input-border);
  transition: background 0.3s, color 0.3s;
}

body.dark header {
  background: var(--header-bg-dark);
  color: var(--header-text);
}

nav a {
  color: var(--header-text);
  margin: 0 10px;
  text-decoration: none;
  font-weight: bold;
  transition: color 0.3s;
}

nav a.active { text-decoration: underline; }
nav a:hover { color: var(--btn-bg); }

#modeToggle {
  margin-top: 10px;
  padding: 6px 12px;
  border: none;
  border-radius: 5px;
  background: var(--btn-bg);
  color: var(--btn-text);
  cursor: pointer;
  transition: background 0.3s, color 0.3s;
}

.container {
  max-width: 500px;
  margin: 30px auto;
  padding: 0 15px;
}

.form-section {
  background: var(--card-bg);
  padding: 20px;
  margin-bottom: 20px;
  border-radius: 10px;
  box-shadow: 0 2px 5px rgba(0,0,0,0.1);
  transition: background 0.3s, color 0.3s, box-shadow 0.3s;
}

.form-section h2 { margin-top: 0; text-align: center; }

.form-section input {
  width: 100%;
  padding: 10px;
  margin: 8px 0;
  border-radius: 5px;
  border: 1px solid var(--input-border);
  background: var(--input-bg);
  color: var(--text);
  transition: all 0.3s;
}

.form-section button {
  width: 100%;
  padding: 10px;
  margin-top: 10px;
  border-radius: 5px;
  border: none;
  background: var(--btn-bg);
  color: var(--btn-text);
  cursor: pointer;
  transition: background 0.3s, color 0.3s;
}

.form-section button:hover { background: var(--primary-dark); }

.password-container { position: relative; }

.toggle-pass {
  position: absolute;
  top: 50%;
  right: 10px;
  transform: translateY(-50%);
  cursor: pointer;
  color: var(--primary);
  font-size: 14px;
}

.error-msg { color: var(--error); font-size: 14px; margin-top: 5px; display: none; }
.success-msg { color: var(--success); font-size: 14px; margin-top: 5px; display: none; }

footer {
  background: var(--card-bg);
  color: var(--text);
  padding: 30px;
  margin-top: 40px;
  text-align: center;
  border-top: 1px solid var(--input-border);
  transition: background 0.3s, color 0.3s, border 0.3s;
}

footer a { margin:0 5px; text-decoration: none; color: var(--btn-bg); transition: color 0.3s; }
footer a:hover { color: var(--primary-dark); }

#btnTop {
  position: fixed;
  bottom: 30px;
  right: 30px;
  display: none;
  background: var(--primary);
  color: var(--btn-text);
  border: none;
  padding: 10px 14px;
  border-radius: 50%;
  font-size: 20px;
  cursor: pointer;
  transition: all 0.3s;
}

#btnTop:hover { background: var(--primary-dark); }

</style>
</head>
<body>

<header>
  <h1>üè° Location Maisons</h1>
  <nav>
    <a href="accueil.html">Accueil</a> |
    <a href="favoris.html" > Mes favoris</a> |
    <a href="Reservation.html">R√©servation</a> |
    <a href="Tableau de bord.html">Tableau de bord</a>
  </nav>
  <button id="modeToggle">üåô Mode sombre</button>
</header>

<div class="container">

  <!-- Inscription -->
  <div class="form-section" id="inscription-section">
    <h2>Cr√©er un compte propri√©taire</h2>
    <form id="form-inscription">
      <input id="nom" type="text" placeholder="Nom complet" required>
      <input id="email-inscription" type="email" placeholder="Email" required>
      <input id="telephone" type="tel" placeholder="T√©l√©phone" required>
      <div class="password-container">
        <input id="password-inscription" type="password" placeholder="Mot de passe (‚â•6 caract√®res)" required>
        <span class="toggle-pass" data-target="password-inscription">üëÅÔ∏è</span>
      </div>
      <div class="password-container">
        <input id="password-confirm" type="password" placeholder="Confirmer mot de passe" required>
        <span class="toggle-pass" data-target="password-confirm">üëÅÔ∏è</span>
      </div>
      <button type="submit">S'inscrire</button>
      <p id="inscription-error" class="error-msg"></p>
      <p id="inscription-success" class="success-msg"></p>
    </form>
  </div>

  <!-- Connexion -->
  <div class="form-section" id="connexion-section">
    <h2>Se connecter</h2>
    <form id="form-connexion">
      <input id="email-connexion" type="email" placeholder="Email" required>
      <div class="password-container">
        <input id="password-connexion" type="password" placeholder="Mot de passe" required>
        <span class="toggle-pass" data-target="password-connexion">üëÅÔ∏è</span>
      </div>
      <button type="submit">Se connecter</button>
      <p id="connexion-error" class="error-msg"></p>
      <p id="connexion-success" class="success-msg"></p>
    </form>
  </div>

</div>

<footer>
  <div>
    <h3>Location Maisons</h3>
    <p>Votre plateforme pour trouver ou publier des maisons √† louer facilement.</p>
  </div>
  <div>
    <a href="accueil.html">Accueil</a> |
    <a href="favoris.html" > Mes favoris</a> |
    <a href="Reservation.html">R√©servation</a> |
    <a href="Tableau de bord.html">Tableau de bord</a>
  </div>
  <div style="margin-top:10px;">
    <p>üìß contact@locationmaisons.com | üìû +229 90 00 00 00</p>
  </div>
  <div style="margin-top:10px;">
    <a href="#">Facebook</a> ‚Ä¢
    <a href="#">Instagram</a> ‚Ä¢
    <a href="#">LinkedIn</a>
  </div>
  <p style="margin-top:15px; font-size:13px; color:var(--text);">¬© 2025 Location Maisons - Tous droits r√©serv√©s</p>
</footer>

<button id="btnTop" title="Haut">‚Üë</button>

<script>
const BASE_URL = 'http://localhost:3000/api';

// --- Dark mode complet + persistance ---
const toggleBtn = document.getElementById('modeToggle');
function setDarkMode(on){
  document.body.classList.toggle('dark', on);
  toggleBtn.textContent = on ? '‚òÄÔ∏è Mode clair' : 'üåô Mode sombre';
  localStorage.setItem('theme', on ? 'dark' : 'light');
}
setDarkMode(localStorage.getItem('theme')==='dark');
toggleBtn.addEventListener('click', ()=> setDarkMode(!document.body.classList.contains('dark')));

// --- Bouton retour haut ---
const btnTop = document.getElementById('btnTop');
window.addEventListener('scroll', () => { btnTop.style.display = window.scrollY > 200 ? 'block' : 'none'; });
btnTop.addEventListener('click', () => window.scrollTo({top:0,behavior:'smooth'}));

// --- Toggle mot de passe ---
document.querySelectorAll('.toggle-pass').forEach(span => {
  span.addEventListener('click', () => {
    const target = document.getElementById(span.dataset.target);
    target.type = target.type==='password' ? 'text' : 'password';
  });
});

// --- Inscription ---
document.getElementById('form-inscription').addEventListener('submit', async e => {
  e.preventDefault();
  const errorEl = document.getElementById('inscription-error');
  const successEl = document.getElementById('inscription-success');
  errorEl.style.display='none'; successEl.style.display='none';

  const nom = document.getElementById('nom').value.trim();
  const email = document.getElementById('email-inscription').value.trim();
  const telephone = document.getElementById('telephone').value.trim();
  const password = document.getElementById('password-inscription').value;
  const passwordConfirm = document.getElementById('password-confirm').value;

  if(!nom||!email||!telephone||!password||!passwordConfirm){
    errorEl.textContent='Veuillez remplir tous les champs.';
    return errorEl.style.display='block';
  }
  if(password.length<6){ errorEl.textContent='Le mot de passe doit contenir au moins 6 caract√®res.'; return errorEl.style.display='block'; }
  if(password!==passwordConfirm){ errorEl.textContent='Les mots de passe ne correspondent pas.'; return errorEl.style.display='block'; }

  try{
    const res = await fetch(`${BASE_URL}/proprietaire/register`, { method:'POST', headers:{'Content-Type':'application/json'}, body: JSON.stringify({nom,email,telephone,password}) });
    const result = await res.json();
    if(result.success){ successEl.textContent='Inscription r√©ussie ! Connectez-vous.'; successEl.style.display='block'; e.target.reset(); }
    else{ errorEl.textContent=result.error || 'Erreur inscription'; errorEl.style.display='block'; }
  }catch(err){ errorEl.textContent='Erreur r√©seau : '+err.message; errorEl.style.display='block'; }
});

// --- Connexion ---
document.getElementById('form-connexion').addEventListener('submit', async e=>{
  e.preventDefault();
  const errorEl = document.getElementById('connexion-error');
  const successEl = document.getElementById('connexion-success');
  errorEl.style.display='none'; successEl.style.display='none';

  const email = document.getElementById('email-connexion').value.trim();
  const password = document.getElementById('password-connexion').value;
  if(!email||!password){ errorEl.textContent='Veuillez remplir tous les champs.'; return errorEl.style.display='block'; }

  try{
    const res = await fetch(`${BASE_URL}/proprietaire/login`, { method:'POST', headers:{'Content-Type':'application/json'}, body:JSON.stringify({email,password}) });
    const result = await res.json();
    if(res.ok && result.success){
      localStorage.setItem('token', result.token);
      localStorage.setItem('proprietaire', JSON.stringify(result.proprietaire));
      successEl.textContent='Connexion r√©ussie ! Redirection...'; successEl.style.display='block';
      setTimeout(()=> window.location.href='tableau de bord.html',1000);
    }else{ errorEl.textContent=result.error || 'Email ou mot de passe incorrect'; errorEl.style.display='block'; }
  }catch(err){ errorEl.textContent='Erreur r√©seau : '+err.message; errorEl.style.display='block'; }
});
</script>

</body>
</html>
